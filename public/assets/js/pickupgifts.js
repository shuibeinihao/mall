define(["angular","jquery"],function(t,n){"use strict";function e(t){o(t.status<0?"网络错误，请稍后重试！":"请求出错，请稍后重试！")}function o(t){n(".js-error-dialog").removeClass(m).find(".js-error-msg").html(t)}t="default"in t?t.default:t,n="default"in n?n.default:n;var i=function(){var t=!1,n="Webkit Moz O ms Khtml".split(" "),e=document.createElement("div");if(void 0!==e.style.animationName&&(t=!0),!1===t)for(var o=0,i=n.length;o<i;o++)if(void 0!==e.style[n[o]+"AnimationName"]){t=!0;break}return t}(),r=function(t,n,e){i?t.addClass("animated "+n).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){t.removeClass("animated "+n),e&&t.addClass(e)}):e&&t.addClass(e)},a=function(t,n,e){if(!t||!n||!e)return"";var o=t+"-"+n+"-"+e;return o.length>15&&(o="..."+o.substr(-15)),o},s="ontouchstart"in window,d=s?"touchstart":"click",u=window.location;n(function(){s&&n("a.js-a").on(d,function(t){t.preventDefault(),t.stopPropagation(),u.href=t.currentTarget.href})});var l=d,c=t.module("order",[]),f=n("#areaChooser"),m="hidden";c.controller("AllianzController",["$scope","$http",function(t,i){t.address={},t.params={amount:1},t.showChooser=function(){f.removeClass(m),n("#app").addClass("noscroll"),r(f,"slideInRight")},t.hideChooser=function(){n("#app").removeClass("noscroll"),r(f,"slideOutRight",m)},t.isFullfilled=function(){var n=t.address;return n.name&&n.phoneNumber&&n.district&&n.address},t.submit=function(){var r=t.address;if(!r.name)return void n("#whoEl").focus();if(!r.phoneNumber)return void n("#telEl").focus();if(!r.district)return void t.showChooser();if(!r.address)return void n("#addressEl").focus();var a=n(".js-form").get(0),s={address:""+r.province+r.city+r.district+r.address,phone:r.phoneNumber,name:r.name,organization:a.organization.value,id:a.id.value,sign:a.sign.value};i.post("/api/trade/gift/submit-gift",s).then(function(t){var n=t.data;n.success?location.href="/pickupgifts/ok":n.retCode<0?location.href="/pickupgifts/fail":o(n.retMsg)},function(t){return e(t)})}}]),c.directive("orderList",function(){return{restrict:"ACE",link:function(t,e){e.on(l,".js-action",function(t){n(t.target).toggleClass("open").next().toggleClass("hidden").prev().get(0).scrollIntoView()}),e.on(l,".js-target",function(e){var o=n(e.target),i=o.text(),r=o.parent().parent(),s=r.find("> .js-action").text(),d=r.parent().parent(),u=d.find("> .js-action").text();t.$apply(function(){var n=a(u,s,i);t.addressPcd=n,t.address.province=u,t.address.city=s,t.address.district=i,t.hideChooser()})})}}}),n(".js-dialog-ok").on(l,function(){n(".js-error-dialog").addClass(m)}),t.bootstrap(document.getElementById("app"),["order"])});
