define(["jquery","swiper","lazyload","bootstrap/scrollspy","jsonlylightbox"],function(t,n,e,r,i){"use strict";function o(t){return t&&t.__esModule?t.default:t}function a(t,n){return n={exports:{}},t(n,n.exports),n.exports}function c(t){t.stopPropagation(),t.preventDefault(),t.stopImmediatePropagation&&t.stopImmediatePropagation()}function s(t){J||(J=K()),J.find(".js-msg").html(t),J.fadeIn(),setTimeout(function(){J.fadeOut()},2e3)}function u(n){n.keydown(function(n){-1!==t.inArray(n.keyCode,[46,8,9,27,13,110,190])||65===n.keyCode&&(!0===n.ctrlKey||!0===n.metaKey)||n.keyCode>=35&&n.keyCode<=40||(n.shiftKey||n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.preventDefault()})}function l(n,e){n=t.extend({msg:"",onebutton:!1},n),H?H.find(".js-dialog-cancel").off().on(W,function(t){Q(t),H.hide()}).end().find(".js-dialog-ok").off().on(W,function(t){Q(t),e&&"function"==typeof e&&e(),H.hide()}).end():H=t(q).find(".js-dialog-cancel").off().on(W,function(t){Q(t),H.hide()}).end().find(".js-dialog-ok").off().on(W,function(t){Q(t),e&&"function"==typeof e&&e(),H.hide()}).end().appendTo("body"),n.msg&&(H.hide(),H.find(".js-msg").html(n.msg),n.onebutton?H.find(".js-dialog-cancel").hide():H.find(".js-dialog-cancel").show(),H.show())}function f(t){V||(V=X()),t?V.fadeIn():V.hide()}t="default"in t?t.default:t,n="default"in n?n.default:n,e="default"in e?e.default:e;var d=a(function(t,n){n.__esModule=!0,n.default=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}}),p=o(d),v=a(function(t){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)}),h=a(function(t){var n=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)}),m=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},y=function(t,n,e){if(m(t),void 0===n)return t;switch(e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,i){return t.call(n,e,r,i)}}return function(){return t.apply(n,arguments)}},g=function(t){return"object"==typeof t?null!==t:"function"==typeof t},_=function(t){if(!g(t))throw TypeError(t+" is not an object!");return t},b=function(t){try{return!!t()}catch(t){return!0}},j=!b(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),w=v.document,k=g(w)&&g(w.createElement),x=function(t){return k?w.createElement(t):{}},P=!j&&!b(function(){return 7!=Object.defineProperty(x("div"),"a",{get:function(){return 7}}).a}),C=function(t,n){if(!g(t))return t;var e,r;if(n&&"function"==typeof(e=t.toString)&&!g(r=e.call(t)))return r;if("function"==typeof(e=t.valueOf)&&!g(r=e.call(t)))return r;if(!n&&"function"==typeof(e=t.toString)&&!g(r=e.call(t)))return r;throw TypeError("Can't convert object to primitive value")},M=Object.defineProperty,O=j?Object.defineProperty:function(t,n,e){if(_(t),n=C(n,!0),_(e),P)try{return M(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(t[n]=e.value),t},T={f:O},I=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}},S=j?function(t,n,e){return T.f(t,n,I(1,e))}:function(t,n,e){return t[n]=e,t},N=function(t,n,e){var r,i,o,a=t&N.F,c=t&N.G,s=t&N.S,u=t&N.P,l=t&N.B,f=t&N.W,d=c?h:h[n]||(h[n]={}),p=d.prototype,m=c?v:s?v[n]:(v[n]||{}).prototype;c&&(e=n);for(r in e)(i=!a&&m&&void 0!==m[r])&&r in d||(o=i?m[r]:e[r],d[r]=c&&"function"!=typeof m[r]?e[r]:l&&i?y(o,v):f&&m[r]==o?function(t){var n=function(n,e,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,e)}return new t(n,e,r)}return t.apply(this,arguments)};return n.prototype=t.prototype,n}(o):u&&"function"==typeof o?y(Function.call,o):o,u&&((d.virtual||(d.virtual={}))[r]=o,t&N.R&&p&&!p[r]&&S(p,r,o)))};N.F=1,N.G=2,N.S=4,N.P=8,N.B=16,N.W=32,N.U=64,N.R=128;var E=N;E(E.S+E.F*!j,"Object",{defineProperty:T.f});var A=h.Object,B=function(t,n,e){return A.defineProperty(t,n,e)},R=a(function(t){t.exports={default:B,__esModule:!0}}),D=a(function(t,n){n.__esModule=!0;var e=function(t){return t&&t.__esModule?t:{default:t}}(R);n.default=function(){function t(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,e.default)(t,i.key,i)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}()}),U=o(D),F="ontouchstart"in window,L=F?"touchstart":"click",G=window.location;t(function(){F&&t("a.js-a").on(L,function(t){t.preventDefault(),t.stopPropagation(),G.href=t.currentTarget.href})});var W=L,J=void 0,K=function(){return t('<div class="ui-dialog-wrapper ui-alert ui-row"><div class="ui-row-cell ui-row-cell-middle"><span class="loadingtip-msg js-msg"></span></div></div>').appendTo("body")},z=20,$=function(){function n(e){var r=this;p(this,n),this.amount=t(e);var i=t.Callbacks(),o=this.amount.find(".js-amount-input");u(o);var a=+this.amount.find(".js-amount-input").attr("data-limit"),c=+o.data("max");this.minNum=z,a?(this.minNum=Math.min(c,z,a),o.data("max",this.minNum)):(this.minNum=Math.min(c,z),o.data("max",this.minNum));var l=function(t){var n=t;t<1?(n=1,s("商品不能再减少了哦～")):t>r.minNum&&(n=r.minNum,s("商品不能购买更多了哦～")),o.val(n),i.fire(n)};o.on("change blur",function(t){t.preventDefault(),t.stopPropagation();var n=+o.val();l(n),r.updateInputUI()}),this.amount.find(".js-amount-dec").on(W,function(t){t.stopPropagation(),t.preventDefault();var n=+o.val();l(n-1),r.updateInputUI()}),this.amount.find(".js-amount-inc").on(W,function(t){t.stopPropagation(),t.preventDefault();var n=+o.val();l(n+1),r.updateInputUI()}),this.updateInputUI(),this._input=o,this._callbacks=i}return U(n,[{key:"updateInputUI",value:function(){var t=+this.amount.find(".js-amount-input").val();t<2?this.amount.find(".js-amount-dec").addClass("set-gray"):this.amount.find(".js-amount-dec").removeClass("set-gray"),t>=this.minNum?this.amount.find(".js-amount-inc").addClass("set-gray"):this.amount.find(".js-amount-inc").removeClass("set-gray")}},{key:"add",value:function(t){this._callbacks.add(t)}},{key:"setMax",value:function(t,n){t=n?Math.min(t,z,n):Math.min(t,z),this.minNum=t,this._input.val()>t&&(this._input.val(t),this._callbacks.fire(t)),this._input.data("max",t)}},{key:"val",get:function(){return this._input.val()}}]),n}(),q='<div class="ui-dialog-wrapper ui-alert ui-row"><div class="ui-row-cell ui-row-cell-middle"><div class="ui-dialog"><div class="ui-dialog-msg js-msg"></div><div class="ui-dialog-btns js-btns"><span class="ui-dialog-button ui-touchable js-dialog-cancel">取消</span><span class="ui-dialog-button ui-touchable js-dialog-ok">确定</span></div></div></div></div>',H=void 0,Q=function(t){t.preventDefault(),t.stopPropagation()},V=void 0,X=function(){return t('<div class="ui-dialog-wrapper ui-alert ui-row"><div class="ui-row-cell ui-row-cell-middle"><span class="loadingtip-msg js-msg" style="padding:1rem;border-radius: 5px;"><div class="spinner"><div class="spinner-container container1"><div class="circle1"></div><div class="circle2"></div><div class="circle3"></div><div class="circle4"></div></div><div class="spinner-container container2"><div class="circle1"></div><div class="circle2"></div><div class="circle3"></div><div class="circle4"></div></div><div class="spinner-container container3"><div class="circle1"></div><div class="circle2"></div><div class="circle3"></div><div class="circle4"></div></div></div></span></div></div>').appendTo("body")},Y=h.JSON||(h.JSON={stringify:JSON.stringify}),Z=function(t){return Y.stringify.apply(Y,arguments)},tt=a(function(t){t.exports={default:Z,__esModule:!0}}),nt=o(tt),et=Math.ceil,rt=Math.floor,it=function(t){return isNaN(t=+t)?0:(t>0?rt:et)(t)},ot=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t},at=S,ct={}.hasOwnProperty,st=function(t,n){return ct.call(t,n)},ut={},lt={}.toString,ft=function(t){return lt.call(t).slice(8,-1)},dt=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==ft(t)?t.split(""):Object(t)},pt=function(t){return dt(ot(t))},vt=Math.min,ht=function(t){return t>0?vt(it(t),9007199254740991):0},mt=Math.max,yt=Math.min,gt=function(t,n){return t=it(t),t<0?mt(t+n,0):yt(t,n)},_t=v["__core-js_shared__"]||(v["__core-js_shared__"]={}),bt=function(t){return _t[t]||(_t[t]={})},jt=0,wt=Math.random(),kt=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++jt+wt).toString(36))},xt=bt("keys"),Pt=function(t){return xt[t]||(xt[t]=kt(t))},Ct=function(t){return function(n,e,r){var i,o=pt(n),a=ht(o.length),c=gt(r,a);if(t&&e!=e){for(;a>c;)if((i=o[c++])!=i)return!0}else for(;a>c;c++)if((t||c in o)&&o[c]===e)return t||c||0;return!t&&-1}}(!1),Mt=Pt("IE_PROTO"),Ot=function(t,n){var e,r=pt(t),i=0,o=[];for(e in r)e!=Mt&&st(r,e)&&o.push(e);for(;n.length>i;)st(r,e=n[i++])&&(~Ct(o,e)||o.push(e));return o},Tt="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),It=Object.keys||function(t){return Ot(t,Tt)},St=j?Object.defineProperties:function(t,n){_(t);for(var e,r=It(n),i=r.length,o=0;i>o;)T.f(t,e=r[o++],n[e]);return t},Nt=v.document&&document.documentElement,Et=Pt("IE_PROTO"),At=function(){},Bt=function(){var t,n=x("iframe"),e=Tt.length;for(n.style.display="none",Nt.appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),Bt=t.F;e--;)delete Bt.prototype[Tt[e]];return Bt()},Rt=Object.create||function(t,n){var e;return null!==t?(At.prototype=_(t),e=new At,At.prototype=null,e[Et]=t):e=Bt(),void 0===n?e:St(e,n)},Dt=a(function(t){var n=bt("wks"),e=v.Symbol,r="function"==typeof e;(t.exports=function(t){return n[t]||(n[t]=r&&e[t]||(r?e:kt)("Symbol."+t))}).store=n}),Ut=T.f,Ft=Dt("toStringTag"),Lt=function(t,n,e){t&&!st(t=e?t:t.prototype,Ft)&&Ut(t,Ft,{configurable:!0,value:n})},Gt={};S(Gt,Dt("iterator"),function(){return this});var Wt=function(t,n,e){t.prototype=Rt(Gt,{next:I(1,e)}),Lt(t,n+" Iterator")},Jt=function(t){return Object(ot(t))},Kt=Pt("IE_PROTO"),zt=Object.prototype,$t=Object.getPrototypeOf||function(t){return t=Jt(t),st(t,Kt)?t[Kt]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?zt:null},qt=Dt("iterator"),Ht=!([].keys&&"next"in[].keys()),Qt=function(){return this},Vt=function(t,n,e,r,i,o,a){Wt(e,n,r);var c,s,u,l=function(t){if(!Ht&&t in v)return v[t];switch(t){case"keys":case"values":return function(){return new e(this,t)}}return function(){return new e(this,t)}},f=n+" Iterator",d="values"==i,p=!1,v=t.prototype,h=v[qt]||v["@@iterator"]||i&&v[i],m=h||l(i),y=i?d?l("entries"):m:void 0,g="Array"==n?v.entries||h:h;if(g&&(u=$t(g.call(new t)))!==Object.prototype&&Lt(u,f,!0),d&&h&&"values"!==h.name&&(p=!0,m=function(){return h.call(this)}),a&&(Ht||p||!v[qt])&&S(v,qt,m),ut[n]=m,ut[f]=Qt,i)if(c={values:d?m:l("values"),keys:o?m:l("keys"),entries:y},a)for(s in c)s in v||at(v,s,c[s]);else E(E.P+E.F*(Ht||p),n,c);return c},Xt=function(t){return function(n,e){var r,i,o=String(ot(n)),a=it(e),c=o.length;return a<0||a>=c?t?"":void 0:(r=o.charCodeAt(a),r<55296||r>56319||a+1===c||(i=o.charCodeAt(a+1))<56320||i>57343?t?o.charAt(a):r:t?o.slice(a,a+2):i-56320+(r-55296<<10)+65536)}}(!0);Vt(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,e=this._i;return e>=n.length?{value:void 0,done:!0}:(t=Xt(n,e),this._i+=t.length,{value:t,done:!1})});var Yt=function(t,n){return{value:n,done:!!t}};Vt(Array,"Array",function(t,n){this._t=pt(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,e=this._i++;return!t||e>=t.length?(this._t=void 0,Yt(1)):"keys"==n?Yt(0,e):"values"==n?Yt(0,t[e]):Yt(0,[e,t[e]])},"values");ut.Arguments=ut.Array;for(var Zt=Dt("toStringTag"),tn=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],nn=0;nn<5;nn++){var en=tn[nn],rn=v[en],on=rn&&rn.prototype;on&&!on[Zt]&&S(on,Zt,en),ut[en]=ut.Array}var an,cn,sn,un=Dt("toStringTag"),ln="Arguments"==ft(function(){return arguments}()),fn=function(t,n){try{return t[n]}catch(t){}},dn=function(t){var n,e,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(e=fn(n=Object(t),un))?e:ln?ft(n):"Object"==(r=ft(n))&&"function"==typeof n.callee?"Arguments":r},pn=function(t,n,e,r){if(!(t instanceof n)||void 0!==r&&r in t)throw TypeError(e+": incorrect invocation!");return t},vn=function(t,n,e,r){try{return r?n(_(e)[0],e[1]):n(e)}catch(n){var i=t.return;throw void 0!==i&&_(i.call(t)),n}},hn=Dt("iterator"),mn=Array.prototype,yn=function(t){return void 0!==t&&(ut.Array===t||mn[hn]===t)},gn=Dt("iterator"),_n=h.getIteratorMethod=function(t){if(void 0!=t)return t[gn]||t["@@iterator"]||ut[dn(t)]},bn=a(function(t){var n={},e={},r=t.exports=function(t,r,i,o,a){var c,s,u,l,f=a?function(){return t}:_n(t),d=y(i,o,r?2:1),p=0;if("function"!=typeof f)throw TypeError(t+" is not iterable!");if(yn(f)){for(c=ht(t.length);c>p;p++)if((l=r?d(_(s=t[p])[0],s[1]):d(t[p]))===n||l===e)return l}else for(u=f.call(t);!(s=u.next()).done;)if((l=vn(u,d,s.value,r))===n||l===e)return l};r.BREAK=n,r.RETURN=e}),jn=Dt("species"),wn=function(t,n){var e,r=_(t).constructor;return void 0===r||void 0==(e=_(r)[jn])?n:m(e)},kn=function(t,n,e){var r=void 0===e;switch(n.length){case 0:return r?t():t.call(e);case 1:return r?t(n[0]):t.call(e,n[0]);case 2:return r?t(n[0],n[1]):t.call(e,n[0],n[1]);case 3:return r?t(n[0],n[1],n[2]):t.call(e,n[0],n[1],n[2]);case 4:return r?t(n[0],n[1],n[2],n[3]):t.call(e,n[0],n[1],n[2],n[3])}return t.apply(e,n)},xn=v.process,Pn=v.setImmediate,Cn=v.clearImmediate,Mn=v.MessageChannel,On=0,Tn={},In=function(){var t=+this;if(Tn.hasOwnProperty(t)){var n=Tn[t];delete Tn[t],n()}},Sn=function(t){In.call(t.data)};Pn&&Cn||(Pn=function(t){for(var n=[],e=1;arguments.length>e;)n.push(arguments[e++]);return Tn[++On]=function(){kn("function"==typeof t?t:Function(t),n)},an(On),On},Cn=function(t){delete Tn[t]},"process"==ft(xn)?an=function(t){xn.nextTick(y(In,t,1))}:Mn?(cn=new Mn,sn=cn.port2,cn.port1.onmessage=Sn,an=y(sn.postMessage,sn,1)):v.addEventListener&&"function"==typeof postMessage&&!v.importScripts?(an=function(t){v.postMessage(t+"","*")},v.addEventListener("message",Sn,!1)):an="onreadystatechange"in x("script")?function(t){Nt.appendChild(x("script")).onreadystatechange=function(){Nt.removeChild(this),In.call(t)}}:function(t){setTimeout(y(In,t,1),0)});var Nn={set:Pn,clear:Cn},En=Nn.set,An=v.MutationObserver||v.WebKitMutationObserver,Bn=v.process,Rn=v.Promise,Dn="process"==ft(Bn),Un=Dt("species"),Fn=Dt("iterator"),Ln=!1;try{var Gn=[7][Fn]();Gn.return=function(){Ln=!0},Array.from(Gn,function(){throw 2})}catch(t){}var Wn,Jn,Kn,zn=Nn.set,$n=function(){var t,n,e,r=function(){var r,i;for(Dn&&(r=Bn.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?e():n=void 0,r}}n=void 0,r&&r.enter()};if(Dn)e=function(){Bn.nextTick(r)};else if(An){var i=!0,o=document.createTextNode("");new An(r).observe(o,{characterData:!0}),e=function(){o.data=i=!i}}else if(Rn&&Rn.resolve){var a=Rn.resolve();e=function(){a.then(r)}}else e=function(){En.call(v,r)};return function(r){var i={fn:r,next:void 0};n&&(n.next=i),t||(t=i,e()),n=i}}(),qn=v.TypeError,Hn=v.process,Qn=v.Promise,Hn=v.process,Vn="process"==dn(Hn),Xn=function(){},Yn=!!function(){try{var t=Qn.resolve(1),n=(t.constructor={})[Dt("species")]=function(t){t(Xn,Xn)};return(Vn||"function"==typeof PromiseRejectionEvent)&&t.then(Xn)instanceof n}catch(t){}}(),Zn=function(t,n){return t===n||t===Qn&&n===Kn},te=function(t){var n;return!(!g(t)||"function"!=typeof(n=t.then))&&n},ne=function(t){return Zn(Qn,t)?new ee(t):new Jn(t)},ee=Jn=function(t){var n,e;this.promise=new t(function(t,r){if(void 0!==n||void 0!==e)throw qn("Bad Promise constructor");n=t,e=r}),this.resolve=m(n),this.reject=m(e)},re=function(t){try{t()}catch(t){return{error:t}}},ie=function(t,n){if(!t._n){t._n=!0;var e=t._c;$n(function(){for(var r=t._v,i=1==t._s,o=0;e.length>o;)!function(n){var e,o,a=i?n.ok:n.fail,c=n.resolve,s=n.reject,u=n.domain;try{a?(i||(2==t._h&&ce(t),t._h=1),!0===a?e=r:(u&&u.enter(),e=a(r),u&&u.exit()),e===n.promise?s(qn("Promise-chain cycle")):(o=te(e))?o.call(e,c,s):c(e)):s(r)}catch(t){s(t)}}(e[o++]);t._c=[],t._n=!1,n&&!t._h&&oe(t)})}},oe=function(t){zn.call(v,function(){var n,e,r,i=t._v;if(ae(t)&&(n=re(function(){Vn?Hn.emit("unhandledRejection",i,t):(e=v.onunhandledrejection)?e({promise:t,reason:i}):(r=v.console)&&r.error&&r.error("Unhandled promise rejection",i)}),t._h=Vn||ae(t)?2:1),t._a=void 0,n)throw n.error})},ae=function(t){if(1==t._h)return!1;for(var n,e=t._a||t._c,r=0;e.length>r;)if(n=e[r++],n.fail||!ae(n.promise))return!1;return!0},ce=function(t){zn.call(v,function(){var n;Vn?Hn.emit("rejectionHandled",t):(n=v.onrejectionhandled)&&n({promise:t,reason:t._v})})},se=function(t){var n=this;n._d||(n._d=!0,n=n._w||n,n._v=t,n._s=2,n._a||(n._a=n._c.slice()),ie(n,!0))},ue=function(t){var n,e=this;if(!e._d){e._d=!0,e=e._w||e;try{if(e===t)throw qn("Promise can't be resolved itself");(n=te(t))?$n(function(){var r={_w:e,_d:!1};try{n.call(t,y(ue,r,1),y(se,r,1))}catch(t){se.call(r,t)}}):(e._v=t,e._s=1,ie(e,!1))}catch(t){se.call({_w:e,_d:!1},t)}}};Yn||(Qn=function(t){pn(this,Qn,"Promise","_h"),m(t),Wn.call(this);try{t(y(ue,this,1),y(se,this,1))}catch(t){se.call(this,t)}},Wn=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},Wn.prototype=function(t,n,e){for(var r in n)e&&t[r]?t[r]=n[r]:S(t,r,n[r]);return t}(Qn.prototype,{then:function(t,n){var e=ne(wn(this,Qn));return e.ok="function"!=typeof t||t,e.fail="function"==typeof n&&n,e.domain=Vn?Hn.domain:void 0,this._c.push(e),this._a&&this._a.push(e),this._s&&ie(this,!1),e.promise},catch:function(t){return this.then(void 0,t)}}),ee=function(){var t=new Wn;this.promise=t,this.resolve=y(ue,t,1),this.reject=y(se,t,1)}),E(E.G+E.W+E.F*!Yn,{Promise:Qn}),Lt(Qn,"Promise"),function(t){var n="function"==typeof h[t]?h[t]:v[t];j&&n&&!n[Un]&&T.f(n,Un,{configurable:!0,get:function(){return this}})}("Promise"),Kn=h.Promise,E(E.S+E.F*!Yn,"Promise",{reject:function(t){var n=ne(this);return(0,n.reject)(t),n.promise}}),E(E.S+!0*E.F,"Promise",{resolve:function(t){if(t instanceof Qn&&Zn(t.constructor,this))return t;var n=ne(this);return(0,n.resolve)(t),n.promise}}),E(E.S+E.F*!(Yn&&function(t,n){if(!n&&!Ln)return!1;var e=!1;try{var r=[7],i=r[Fn]();i.next=function(){return{done:e=!0}},r[Fn]=function(){return i},t(r)}catch(t){}return e}(function(t){Qn.all(t).catch(Xn)})),"Promise",{all:function(t){var n=this,e=ne(n),r=e.resolve,i=e.reject,o=re(function(){var e=[],o=0,a=1;bn(t,!1,function(t){var c=o++,s=!1;e.push(void 0),a++,n.resolve(t).then(function(t){s||(s=!0,e[c]=t,--a||r(e))},i)}),--a||r(e)});return o&&i(o.error),e.promise},race:function(t){var n=this,e=ne(n),r=e.reject,i=re(function(){bn(t,!1,function(t){n.resolve(t).then(e.resolve,r)})});return i&&r(i.error),e.promise}});var le=h.Promise,fe=a(function(t){t.exports={default:le,__esModule:!0}}),de=o(fe),pe=function(n,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments[4];return new de(function(a,c){t.ajax({method:r,url:n,headers:o,async:i,contentType:"application/json",dataType:"json",data:nt(e),success:a,error:function(t){try{c(JSON.parse(t.responseText))}catch(n){c({error:!0,message:"解析JSON出错: "+t.responseText})}}})})};new n(".swiper-container",{pagination:".swiper-pagination",loop:!0,autoplay:0,lazyLoading:!0,autoplayDisableOnInteraction:!1});var ve=function(t){return new $(t)}(".js-spec-amount"),he=t(".js-spec-item").attr("data-availableInStock"),me=t(".js-cartlabel"),ye=t(".js-spec-submit"),ge=t("#spec-itembox"),_e=0,be=window.location.search.substr(1),je=t(".goCart").attr("data-productId");usid?pe("/api/trade/cart",{},"GET").then(function(n){if(n.items.length){var e=n.snapshot.allNum;e>9?t(".js-cartlabel").text("N"):t(".js-cartlabel").text(e)}else t(".js-cartlabel").remove()}).catch(function(n){"NoGuest"===n.errorCode&&t(".js-cartlabel").remove()}):t(".js-cartlabel").remove();var we=function(){var t=ge.find(".spec-active").data("id"),n=+ve.val;switch(pe("/api/trade/check-buy/"+t+"/"+n,{},"POST").then(function(t){!1===t.success&&l({msg:t.retMsg,onebutton:!0},function(){location.reload(!0)})}).catch(function(t){var n="";"NoGuest"===t.errorCode?(n="请先登录",l({msg:n,onebutton:!0},function(){window.location="/user/login?redirect="+encodeURIComponent(document.URL)})):s("网络错误，请稍后重试！")}),_e){case 3:ye.attr("href","/gp/order?p="+t+"_"+n+"&&buyRoute=2&&"+be),ye.attr("onclick","xksTrack.track('MobileMall:Product_Details:Confirm_Buy_Now:Click',{'productId':'"+je+"'});$('.js-spec-dialog,.js-spec-dialogBg').hide();$('html,body').css('overflow', '');$('.js-actions').show();currentType =0;mixpanel.track('MobileMall: Product Details: Confirm Buy Now: Click');")}};ve.add(we);var ke=function(){t(".js-spec-dialog,.js-spec-dialogBg").hide(),t("html,body").css("overflow",""),t(".js-actions").show(),_e=0},xe=function(n){t(".js-spec-dialog,.js-spec-dialogBg").show(),t("html,body").css("overflow","hidden"),t(".js-actions").hide(),_e=n,we()},Pe=function(n){var e=n;t(".js-amount-dec").removeClass("set-gray"),t(".js-amount-inc").removeClass("set-gray");var r=e.attr("data-availableInStock"),i=e.attr("data-buyLimit");i?(ve.setMax(r,i),ve.updateInputUI()):(ve.setMax(r),ve.updateInputUI()),e.addClass("spec-active").siblings(".spec-active").removeClass("spec-active"),t(".js-spec-availableInStock").text(r),t(".js-spec .js-spec-price").text(e.data("selling-price")),t(".js-price-xinbi").text(e.data("xinbi-price")),t(".js-spec-image").attr("src",e.data("image")),t(".js-amount-input").attr("data-max",r),he=r};t(".js-spec-item").each(function(){if(!t(this).hasClass("disabled"))return Pe(t(this)),!1}),t(".js-spec-item").on(W,function(n){Pe(t(n.target)),we()}),t(".js-spec-close,.js-spec-dialogBg").on(W,function(n){c(n),ke(),t(".customer-pop,.iframe-close").hide()});var Ce=!1,Me=function(t){if(c(t),!Ce){Ce=!0;var n=+ve.val,e=ge.find(".spec-active").data("id");f(!0),pe("/api/trade/add-shopping-cart/"+e+"/"+n,{},"POST").then(function(t){if(Ce=!1,ke(),f(!1),t.success){var e=+me.data("number"),r=e+n;me.data("number",r),me.text(r>9?"N":r),me.hasClass("hidden")&&me.show(),s("已成功加入购物车"),location.reload(!0)}else l({msg:t.retMsg,onebutton:!0})}).catch(function(t){f(!1);var n="加入购物车出错";"NoGuest"===t.errorCode&&(n="请先登录",Ce=!1,ke(),l({msg:n,onebutton:!0},function(){window.location="/user/login?redirect="+encodeURIComponent(document.URL)}))})}};ye.on(W,function(t){2===_e&&(xksTrack.track("MobileMall:Product_Details:Confirm_Add_Cart:Click",{productId:je}),Me(t))}),t(function(){t("body").scrollspy({target:"#navbar-product",offset:90}),new e,(new Lightbox).load(),t(".js-describe img").css({width:"",height:""}),t(".product-swipper-img").click(function(){var n=t(this).attr("data-index");xksTrack.track("MobileMall:Product_Details:Product_Images:Click",{imgIndex:n,productId:je})})}),t(".goCart").click(function(){location.href="/gp/cart?"+be}),t(function(){t(".product-nav-top ul li a").click(function(){if(t(this).addClass("active").parent().siblings().find("a").removeClass("active"),location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var n=t(this.hash);if(n=n.length&&n||t("[name="+this.hash.slice(1)+"]"),n.length){var e=n.offset().top-82;return t("html,body").animate({scrollTop:e},500),!1}}})}),t(".js-to-cart").on(W,function(t){c(t),xksTrack.track("MobileMall:Product_Details:Add_Cart:Click",{productId:je}),xe(2)}),t(".js-to-purchase").on(W,function(t){c(t),xksTrack.track("MobileMall:Product_Details:Buy_Now:Click",{productId:je}),xe(3)}),t(".product-icon").click(function(){t(".product-slide-nav").slideToggle()}),function(){t(".js-customer").click(function(){var n=t(".customer-pop").attr("data-url");t(".customer-pop iframe").attr("src",n),t(".js-spec-dialogBg,.customer-pop,.iframe-close").show()}),t(".js-spec-dialogBg,.iframe-close").click(function(){t(".js-spec-dialogBg,.customer-pop,.iframe-close").hide()})}(),function(){var n="";t(".commentReply").click(function(){n=t(this).attr("data-commentId"),t(".commentPopWrap").show()}),t(".commentPopBg,.commentCancelBtn").click(function(){t(".commentPopWrap").hide()}),t(".commentOkBtn").click(function(){var e=t(".replyText").val();if(e){t(".commentPopWrap").hide();var r="/api/trade/comment/"+n+"/reply",i={content:e};f(!0),pe(r,i,"POST").then(function(){f(!1),t(".replyText").val(""),s("回复成功！"),location.reload(!0)}).catch(function(){f(!1),t(".replyText").val(""),s("网络错误，请稍后重试！")})}else s("请输入要回复的内容")})}()});
